---
layout: post
title:  "IFE task003总结"
date:   2015-06-30 19:58:30
categories: jekyll update
---
> 一旦你开始做，你就会发现，其实也并不难嘛！

4月份参加了百度的前端培训，刚开始培训那会热情高涨，整整一个多月都是除了吃饭睡觉就是看书写代码看书写代码，任务一任务二勉强在任务截止之前提交了，
然而看到任务三整个人都不好了…这，这是一个才接触一两个月前端的人写的出来的东西吗？

答案告诉我：并不是；

如果你没有编程能力的话，是很难写出让自己不崩溃的代码的。

第一次编码时，按照自己能够写出来的效果，先实现了静态页面，接着写左边的手风琴目录，然后开始写如何添加一个分类，完全顺着页面来，写到判断分类判断完成未完成时我的逻辑就崩塌了。
写不下去怎么办，参考别人的代码吧。于是开始看同学的代码，发现有个同学利用数据库的思想先将主分类、二级分类、任务的各种对应关系写好。编写各种逻辑，能够通过ID，查找cate,childCate,task,
能够根据cate,childCate查找task,根据cate.id查找childCate,逐渐完善自己需要的增删改查。

接着就是要根据拿到的object数组来渲染页面了。在渲染时给每个cate,childCate,task都加上对应的id,方便以后读取。

然后遇到的最大的问题就是，如何获得当前用户所指定的分类。

添加任务的时候，要根据目前用户所选中的分类来给任务设置pid,但是这个分类要怎么获取，设置了一个getActive函数，然而他的返回值不能传递给添加任务这个函数，因为函数的作用域变了。
在全局作用域中，他可以得到用户点击的domId,然而在另一个函数中执行的时候，上下文环境变了，得到的永远都是null。最后想了想，还是设定一个全局变量，得到domId之后赋值给全局变量，就可以得到当前的ID了~

这个最大的问题解决之后，其他的都不是难事了。完成任务也只是时间的问题。

其实最难的还是删除，删着删着就undefined了，就会报错了。我是想要利用delTask这个函数的，但是该函数每次删完之后会自动更新它childCate的child数组，但由于是双重循环在第二次遍历的时候由于该task已经被删除了，所以
会出现`cannot find id in undefined` 索性就直接在localStorage里面删，分别得到要删除的任务数组，二级分类的数组，主分类的数组，这样不存在嵌套关系，就可以无痛删除。

这样写的最大好处就是，逻辑和页面完全分开，把逻辑都写好了，页面只要能够读取数据并拼接HTML输出就OK了。

不过还有一个问题，每次添加完页面之后都需要刷新一次才能看得到更新。我用了window.location.reload来刷新页面。（我知道肯定不是这么做，这样会引起闪屏）勉强实现了任务三该有的功能。

细节问题就需要时间的调试了。但是能够写出这个样子就已经证明，万事开头难，只要开始做，就不怕做不出来的。

阿里内推又开始了，因为阿里开始前端，如今四个月过去，功力如何？希望在7月能够比较完美的完成任务三和任务四。再加上黑猫之前说的chrome插件。恩，善始善终~
开始期待7月份的实习了，感觉可以学到好多知识好开心~